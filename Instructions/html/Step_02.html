
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Step 2: Modeling Standards</title><meta name="generator" content="MATLAB 9.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2018-10-27"><meta name="DC.source" content="Step_02.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:14px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:2.0em; color:#000077; line-height:150%; font-weight:bold; text-align:center }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.6em; color:#444444; font-weight:bold; font-style:italic; text-align:left; vertical-align:bottom; line-height:200%; border-top:2px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#555555; font-style:italic; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px;} 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Step 2: Modeling Standards</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Introduction</a></li><li><a href="#2">Verification and Validation Tools Used</a></li><li><a href="#3">Using Edit Time Checking</a></li><li><a href="#4">Opening the Metrics Dashboard</a></li><li><a href="#5">Fixing the Non-Compliant Checks</a></li><li><a href="#6">Excluding Blocks from Model Advisor Analysis</a></li><li><a href="#7">Adding Custom Checks to Model Advisor</a></li><li><a href="#8">Customizing Model Advisor Menu</a></li><li><a href="#9">Summary</a></li></ul></div><h2>Introduction<a name="1"></a></h2><p><img vspace="5" hspace="5" src="Step_02_CruiseControl_WhatNow.png" alt=""> </p><p>Model Advisor finds unwanted model properties, such as incorrect or deprecated blocks and block parameters, non-robust model constructs and other practices that do not facilitate consistentcy, readability and sharing.  Model Advisor is a part of the Simulink basic functionality, but <b>Simulink Check</b> extends the Model Advisor capability by providing the user with pre-defined "checks" based on the following industry safety standards:</p><div><ul><li>ISO 26262 Checks</li><li>IEC 61508 Checks</li><li>IEC 62304 Checks</li><li>EN 50128 Checks</li><li>DO-178C and DO-331 Checks</li></ul></div><p>A "check" in Model Advisor means a rule that the tool will use to examine your model and flag any settings that don't agree with the pre-defined criteria.  The set of checks provided by <b>Simulink Check</b> can be seen under the <b>By Product/Simulink Check</b> folder.</p><p>MathWorks has created a set of modeling guidelines by leveraging industry best practices and the MathWorks expertise in developing high-integrity systems.  These high-integrity guidelines have been interpreted into checks addressing the specifics of safety standards like ISO 26262.  Each check includes a description, a rationale and an example where applicable.</p><p><b>Simulink Check</b> also extends the Model Advisor capability by providing additional automotive model style guidelines:</p><div><ul><li>MathWorks Automotive Advisory Board Checks (MAAB Style Guidelines)</li></ul></div><p>MathWorks Automotive Advisory Board (MAAB) checks facilitate designing and troubleshooting models from which code is generated for automotive applications. The MathWorks&reg; Automotive Advisory Board (MAAB) involves major automotive OEMs and suppliers in the process of evolving MathWorks controls, simulation, and code generation products</p><p>In addition to the modeling standard checks listed above, <b>Simulink Check</b> provides the following functionality:</p><div><ol><li>Application program interface (API) for building custom checks.</li><li>Model Metrics checks</li></ol></div><p><img vspace="5" hspace="5" src="Step_02_MA_ListOfChecks.png" alt=""> </p><p>The Embedded Coder product also adds checks to Model Advisor:</p><div><ul><li>MISRA C:2012 Checks</li></ul></div><p><img vspace="5" hspace="5" src="Step_02_MA_MISRA_Checks.png" alt=""> </p><p>The "MISRA C:2012 Checks" check the model and code generation configuration for generating efficient production code.  These checks identify configuration parameters that might impact MISRA C:2012 compliant code generation to increass the likelihood of generating MISRA C:2012 compliant code.  The final check for MISRA C:2012 would be performed by <b>Polyspace</b>, a static analysis tool that analyzes the generated code.</p><h2>Verification and Validation Tools Used<a name="2"></a></h2><div><ul><li>Simulink Check</li></ul></div><h2>Using Edit Time Checking<a name="3"></a></h2><p><b>Model Advisor</b> has a comprehensive set of checks that can be used to verify the model has been constructed and configured to ensure standards compliance as discussed above.  What if we could perform these checks earlier in the development process?  It is possible to perform a subset of these checks to detect compliance issues at design time.  There is a feature called <b>edit-time checking</b> that will check the model as it is being design or constructed. To enable <b>edit-time checking</b>, do the following:</p><div><ul><li>Open the <b>CruiseControl_Req.slx</b> &#8211; <b><a href="matlab:copyReqsMdl('CruiseControl_Req','CruiseControl_Req');open_system('CruiseControl_Req.slx')">click here</a></b></li></ul></div><div><ul><li>Go to <b>Analysis/Model Advisor/Model Advisor/Display Advisor Checks in Editor</b></li></ul></div><p><img vspace="5" hspace="5" src="Step_02_EditTimeMenuEnable.png" alt=""> </p><p>After <b>edit-time checking</b> has been enabled, the checks have been automatically run and the results displayed on the model canvas.</p><p>Note the name violation found for the subsystem "Compute target speed". To fix the violation:</p><div><ul><li>Remove the spaces in the block name by renaming the block to "ComputeTargetSpeed"</li></ul></div><p><img vspace="5" hspace="5" src="Step_02_EditTimeModelIssue.png" alt=""> </p><p>Open the state chart to find another violation regarding the "ON" state. To fix the violation:</p><div><ul><li>Add a CR to place "engaged = true;" on a separate line.</li></ul></div><p><img vspace="5" hspace="5" src="Step_02_EditTimeStateflowIssue.png" alt=""> </p><p>Notice the "Accel" and "Coast" states have the same issue with the same fix:</p><div><ul><li>For the "Accel" state, add a CR to place "tspeed = tspeed + incdec;" on a separate line.</li><li>For the "Coast" state, add a CR to place "tspeed = tspeed - incdec;" on a separate line.</li></ul></div><p>All issues identified by <b>Edit Time Checking</b> have been fixed.  Next we will use the <b>Metrics Dashboard</b> to perform a more detailed standards compliance check.</p><h2>Opening the Metrics Dashboard<a name="4"></a></h2><p>For the all of the checks including the edit-time checks we will use the <b>Metrics Dashboard</b> to determine and demonstrate if the model is in compliance with</p><div><ul><li>ISO 26262</li><li>MAAB Style Guidelines</li><li>MISRA C:2012</li></ul></div><p>The <b>Metrics Dashboard</b> collects and integrates quality metric data from multiple Model-Based Design tools to provide you with an assessment of your project quality status.  The <b>Metrics Dashboard</b> contains widgets that provide visualization of metric data in these categories: size, modeling guideline compliance, and architecture.</p><p>Before we open the <b>Metrics Dashboard</b>, we will run a script to configure the dashboard to obtain compliance metrics for ISO 26262, MAAB and MISRA.</p><p>1.  Configure the <b>Metrics Dashboard</b> &#8211; <b><a href="matlab:setMetricsDashCfg();">click here</a></b></p><p>2.  If not opened, open the <b>CruiseControl_Req.slx</b> model &#8211; <b><a href="matlab:B0_MdlAdv_ReqLink;">click here</a></b></p><p>If opened, model changes from the <b>edit-time checking</b> section will be lost.</p><p>3.  To open the <b>Metrics Dashboard</b>, make the menu selection <b>Analysis/Metrics Dashboard</b></p><p><img vspace="5" hspace="5" src="Step_02_MA_Dashboard1.png" alt=""> </p><p>4.  Select <b>All Metrics</b> to analyze the model for standards compliance.</p><p>A progress bar will popup to show what checks are being executed.  Once completed the compliance metrics will be shown on the <b>Metrics Dashboard</b>.</p><p><img vspace="5" hspace="5" src="Step_02_MA_Dashboard2.png" alt=""> </p><p>To get help with understanding, interpreting and using the <b>Metrics Dashboard</b> - <b><a href="matlab:web(fullfile(docroot,'slcheck/ug/collect-model-metric-data-by-using-the-metrics-dashboard.html'))">click here</a></b> <b><a href="matlab:web(fullfile(docroot,'slcheck/ug/collect-and-explore-metric-data-by-using-metrics-dashboard.html'))">and here</a></b>.</p><p>From the dashboard metrics our model is (92.4%) MAAB compliant. We will now drill down into the MAAB results, fix the issues and demonstrate 100% MAAB compliance.</p><p>5.  To drill down into the MAAB results, select the "MAAB" gauge to bring up the <b>Metrics Details</b> view.</p><p><img vspace="5" hspace="5" src="Step_02_MA_DashboardGrid.png" alt=""> </p><p>The <b>Metrics Details</b> starts in the <b>Grid</b> view.  This can be very useful for integrations of a large number of components or models to see how many components are non-compliant and if the issues are localized or across the organization.  In our case we are analyzing a single component so we will proceed to the <b>Table</b> view with an itemized list of issues.</p><p>6.  Select <b>Table</b> in the toolstrip to show the list of issues.</p><p><img vspace="5" hspace="5" src="Step_02_MA_DashboardTable.png" alt=""> </p><h2>Fixing the Non-Compliant Checks<a name="5"></a></h2><p>We will use <b>Model Advisor</b> to determine the cause of the non-compliance and fix the issues.</p><p>1.  From the <b>Metrics Detail</b> view, select <b>Open results in Model Advisor</b> to open <b>Model Advisor</b>.</p><p>Before we investigate and fix these issues we need to create a <b>restore point</b> so if we decide on a different strategy to handle these issues then we can easily go back to our last "good" model.</p><p>2.  To create a <b>restore point</b> in <b>Model Advisor</b>, select <b>File/Save Restore Point</b></p><p><img vspace="5" hspace="5" src="Step_02_MA_RestorePoint.png" alt=""> </p><p>3.  In the <b>Metrics Dashboard</b>  select "Check font formatting"</p><p><b>Model Advisor</b> will show the "Check font formatting" check within the "Modeling Standards for MAAB/Simulink" section.</p><p><img vspace="5" hspace="5" src="Step_02_MA_FontCheck.png" alt=""> </p><p>Note: Your list of checks might be slightly different than the screen shot. The list of checks is a function of installed products.</p><p>There are (6) warnings* for the "MAAB Checks".  Let's take a look at what is causing these warning messages:</p><div><ul><li><b>Check font formatting</b>-- usage of two font sizes in model; consistency</li><li><b>Check model diagnostic parameters</b>--  (2) diagnostics need to be set to warning or error; workflow, code generation</li><li><b>Check for diagram using nonstandard display attributes</b>-- several issues, use <b>Modify</b> button to fix; consistency</li><li><b>Check for propagated signal labels</b>-- outport signals need to be set for label propagation; readability, code generation, verification &amp; validation</li><li><b>Check default transition placement in Stateflow charts</b>-- default state not the top-most state; readability</li><li><b>Check for comparison operations in Stateflow charts</b>-- value is not cast to the same type as the signal (uint8), change to <b>tspeed!=uint8(0)</b>: code generation, verification &amp; validation</li></ul></div><p>For more detail on any check, select the <b>Help</b> button in the <b>Model Advisor</b> check pane.  You can also <a href="http://www.mathworks.com/automotive/standards/maab.html">download the MAAB style guide</a> from the web for more detailed information.</p><p>4.  First, let's fix "Check font formatting" by</p><div><ul><li>Selecting <b>Run This Check</b></li><li>Selecting <b>Modify All Fonts</b></li><li>Selecting <b>Run This Check</b></li></ul></div><p>The "Check font formatting" check should now pass.</p><p>Follow this general method to fix the remaining checks except for "Check default transition placement in Stateflow charts".  For this check we will use an exclusion method.  For the other checks, after <b>Run This Check</b> there will typically be some type of a "Fix It" button or hyperlinks to navigate to the violation in the model or configuration where the fix can manually be made.</p><p>5.  In <b>Model Advisor</b>, navigate through the non-compliant "MAAB" checks to fix all the checks using the hints above.  Excluding  "Check default transition placement in Stateflow charts" do this for the remaining checks.</p><h2>Excluding Blocks from Model Advisor Analysis<a name="6"></a></h2><p>If you want to exclude a check, you simply uncheck it and it will be exluded from the analysis. You can also put together a custom list of checks to only run those that you think make sense for you. This is covered in the last section of this step.</p><p>However, sometimes you want to run a check on a model, but exclude only specific blocks or specific block types from all checks or individual checks. This is required to show (100%) compliance in the <b>Metrics Dashboard</b>.  The <b>Check default transition placement in Stateflow charts</b> is a good candidate for exclusion since this may require a major rework of the the Stateflow chart.  We will now show how to exclude this block to enable us to pass all the MAAB checks.  We would likely still have to justify this during the model review but as we will see the use of exclusion is documented in the final report.</p><p>1.  In <b>Model Advisor</b>, navigate to the "Stateflow" section and select <b>Check default transition placement in Stateflow charts</b></p><p><img vspace="5" hspace="5" src="Step_02_MA_DefaultPlacement.png" alt=""> </p><p>The <b>Recommended Action</b> is to rearrange the states so the default state is the top-most state. Place the destination state of the default transition above all other states in the state hierarchy.  However, let's say that we approve this deviation from the MAAB standard  for our model. To do this, follow the steps below:</p><p>2.  Select one of the non-compliant states to navigate to the model</p><p>3.  Navigate up one level and select the state chart</p><p>4.  Right-click the state chart block and select <b>Model Advisor/Exclude block only/Select checks ...</b></p><p>5.  Find <b>Check default transition placement in Stateflow charts</b> in the list box.  Look at the relative position in the list box to help find the check (see picture below):</p><p><img vspace="5" hspace="5" src="Step_02_MA_ExcludeDefPlaceSelector.png" alt=""> </p><p>This opens the <b>Model Advisor Exclusion Editor</b></p><p><img vspace="5" hspace="5" src="Step_02_ExclusionDialog.png" alt=""> </p><p>6.  Click the <b>Change</b> button to name the exclusion file</p><p>7.  Click <b>Save as</b> in the dialog that appears, name the file <b>CruiseControl_Req_exclusions.xml</b></p><p>8. Rerun the check <b>Check default transition placement in Stateflow charts</b> under <b>Model Architecture</b> to confirm that this check now passes.</p><p>9.  Return to the <b>Metrics Dashboard</b> and select <b>Dashboard</b> in the toolstrip to return to the dashboard view.</p><p>10.  Run <b>All Metrics</b> to confirm (100%) MAAB compliance.</p><p><img vspace="5" hspace="5" src="Step_02_MA_DashboardPass.png" alt=""> </p><h2>Adding Custom Checks to Model Advisor<a name="7"></a></h2><p>As mentioned at the beginning of this section, <b>Simulink Check</b> allows users to add customized checks to Model Advisor. This is done through the Model Advisor API and the <b>sl_customization.m</b> file.  For this workshop, three new custom checks will be added based on the MATLAB code in <b>sl_customization.m</b> file.</p><p>To use custom checks do the following:</p><p>1.  Close <b>Model Advisor</b> and the <b>Metrics Dashboard</b></p><p>2.  Save <b>CruiseControl_Req.slx</b> &#8211; <b><a href="matlab:save_system('CruiseControl_Req.slx')">click here</a></b></p><p>3.  Close all model files &#8211; <b><a href="matlab:bdclose('all');">click here</a></b></p><p>4.  Setup the <b>sl_customization.m</b> file &#8211; <b><a href="matlab:setupCustomMAchecks;">click here</a></b> (this copies sl_customization.m into the working dir)</p><p>5.  To view <b>sl_customization.m</b> - <b><a href="matlab:edit('sl_customization.m');">click here</a></b></p><p>6.  At the MATLAB command prompt, enter the following command:</p><p>&gt;&gt; <b>Advisor.Manager.refresh_customizations</b> <b><a href="matlab:Advisor.Manager.refresh_customizations">or click here</a></b></p><p>7.  Open the <b>CruiseControl_Req.slx</b> &#8211; <b><a href="matlab:open_system('CruiseControl_Req.slx')">click here</a></b></p><p>8.  Configure the <b>Metrics Dashboard</b> for the new custom checks &#8211; <b><a href="matlab:setMetricsDashCfgCustom();">click here</a></b></p><p>9.  Re-open the <b>Metrics Dashboard</b>.</p><p>10.  Select <b>All Metrics</b> to run all metrics including the new custom checks</p><p><img vspace="5" hspace="5" src="Step_02_MA_DashboardCustom.png" alt=""> </p><p>Notice the third gauge has been reassigned from "MISRA" to "Workshop" to indicate the status of the custom checks.</p><p>11.  Select the "Workshop" gauge to open <b>Metrics Details</b> view.</p><p>12.  Select "Open results in Model Advisor" to see the custom checks in <b>Model Advisor</b></p><p><img vspace="5" hspace="5" src="Step_02_MA_CustomChecks.png" alt=""> </p><p>A new folder has appeared under <b>By Product</b> named <b>Custom Workshop Checks</b> The folder contains the 3 custom checks:</p><div><ul><li>Check Simulink block font</li><li>Check Simulink window screen color</li><li>Check model optimization settings</li></ul></div><p>13. Run through all three of these custom checks and notice the different displays and fix actions for each check.</p><p>In some cases, it is possible have a "*Fix ...*" action, in which Model Advisor would follow a pre-defined or programmed fix action to correct the model for you. Since font type and size have a very "objective" procedure to fix the model, we can implement a "*Fix ...*" action.</p><p>These checks were scripted in MATLAB using the <b>Model Advisor</b> API commands, and added to the <b>Model Advisor</b> UI using the "sl_customization.m" file. When "sl_customization.m" changes, the UI must be refreshed with the <b>Advisor.Manager.refresh_customizations</b> command.</p><h2>Customizing Model Advisor Menu<a name="8"></a></h2><p>In addition to being able to add your own checks, you can also configure the Model Advisor menu with different folders, or different initial check configurations (enable/disable/hidden).</p><p>Do the following:</p><p>1.  Open <b>Model Advisor</b> and select the menu <b>Settings/Open Configuration Editor</b>.</p><p><img vspace="5" hspace="5" src="Step_02_ConfigurationEditorMenu.png" alt=""> </p><p>You should see the following windows open up:</p><p><img vspace="5" hspace="5" src="Step_02_MA_ConfigurationEditor.png" alt=""> </p><p>You can now modify (drag and drop) the check tree structure in the left-hand window using the checks available in the right-hand window.</p><p>2.  Drag and drop check from Right (Source) window to the Left (Destination) window.</p><p>3.  Create and delete folders in the left window.</p><p>4.  Enable or disable specific checks in the left window.</p><p><img vspace="5" hspace="5" src="Step_02_MA_CfgEditorDragDrop.png" alt=""> </p><p>Once you are done, you can save the configuration as a <b>.mat</b> file, and share the configuration setting with others.</p><p>5.  Select <b>File/Save As</b> and save the configuration as <b>CruiseControl_MA_Config.mat</b>.</p><p>Now that you have a custom Model Advisor configuration, let's use it.</p><p>7.  Select <b>File/Set Current Configuration as Default</b>, also press <b>OK</b> to warning popup</p><p>8.  Exit the <b>Model Advisor Configuration Editor</b> and reopen <b>Model Advisor</b></p><p><img vspace="5" hspace="5" src="Step_02_MA_CustomConfig.png" alt=""> </p><p>9.  Another way to load your custom Model Advisor configuration -- In the <b>Model Advisor</b> window, under <b>Settings</b>, select <b>Load Configuration...</b></p><p>10. To restore default settings -- In <b>Model Advisor</b> window, under <b>Settings</b>, select <b>Restore Default Configuration</b>.</p><h2>Summary<a name="9"></a></h2><p>With the functions above, we were able to check our Cruise Control model for compliance with industry, international and company standards, and best practices.  We were able to carry out this task using the base Simulink, Model Advisor tool along with the modeling standards checks provided by <b>Simulink Verification and Validation</b>.</p><p>In the exercises we demonstrated compliance to the MAAB modeling standard. The benefits of complying to the MAAB modeling standard include readability, making the model production code ready, facilitating a standard V&amp;V workflow and enabling re-use.  Additional checks for complying to a safety standard like ISO 26262 are also available to be used as part of an overall process to demonstrate ISO 26262 compliance. The safety standards were not part of the exercises but the same procedure used in the MAAB exercises would apply to demonstrating compliance to the safety standard.</p><p>The standards checking can be customized to fit your model-based design process.  Methods used to provide this customization to your process were also demonstrated:</p><div><ol><li>Custom checks can be created to check models for internal modeling standards</li><li>Custom model checking configurations can include only the checks that apply or provide benefit to your workflow</li></ol></div><p>Going forward we have increased confidence in our design knowing that are model follows a modeling standard.  We have now answered all the questions as we have now demonstrated a structured and formal testing framework for securing the quality, robustness and safety of our cruise controller.</p><p><img vspace="5" hspace="5" src="Step_02_CruiseControl_Summary.png" alt=""> </p><div><ol><li>Close all models - <b><a href="matlab:bdclose('all');">click here</a></b>.</li><li>Go to <b>Step 3: Detecting Design Errors</b> - <b><a href="Step_03.html">click here</a></b>.</li></ol></div><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Step 2: Modeling Standards
%
%% Introduction
%
% <<Step_02_CruiseControl_WhatNow.png>>
%
% Model Advisor finds unwanted model properties, such as incorrect or
% deprecated blocks and block parameters, non-robust model constructs
% and other practices that do not facilitate consistentcy, readability and
% sharing.  Model Advisor is a part of the Simulink basic functionality,
% but *Simulink Check* extends the Model Advisor capability by providing 
% the user with pre-defined "checks" based on the following industry safety
% standards:
%
% * ISO 26262 Checks
% * IEC 61508 Checks
% * IEC 62304 Checks
% * EN 50128 Checks
% * DO-178C and DO-331 Checks
%
% A "check" in Model Advisor means a rule that the tool will use to examine
% your model and flag any settings that don't agree with the pre-defined
% criteria.  The set of checks provided by *Simulink Check* can be seen 
% under the *By Product/Simulink Check* folder.  
%
% MathWorks has created a set of modeling guidelines by leveraging industry
% best practices and the MathWorks expertise in developing high-integrity 
% systems.  These high-integrity guidelines have been interpreted into
% checks addressing the specifics of safety standards like ISO 26262.  Each 
% check includes a description, a rationale and an example where applicable.
%
% *Simulink Check* also extends the Model Advisor capability by providing 
% additional automotive model style guidelines:
%
% * MathWorks Automotive Advisory Board Checks (MAAB Style Guidelines)
%
% MathWorks Automotive Advisory Board (MAAB) checks facilitate designing 
% and troubleshooting models from which code is generated for automotive 
% applications. The MathWorks® Automotive Advisory Board (MAAB) involves 
% major automotive OEMs and suppliers in the process of evolving MathWorks 
% controls, simulation, and code generation products
%
% In addition to the modeling standard checks listed above, *Simulink Check* 
% provides the following functionality:
%
% # Application program interface (API) for building custom checks.
% # Model Metrics checks
%
% <<Step_02_MA_ListOfChecks.png>>
%
% The Embedded Coder product also adds checks to Model Advisor:
%
% * MISRA C:2012 Checks
%
% <<Step_02_MA_MISRA_Checks.png>>
%
% The "MISRA C:2012 Checks" check the model and code generation 
% configuration for generating efficient production code.  These checks 
% identify configuration parameters that might impact MISRA C:2012 
% compliant code generation to increass the likelihood of generating
% MISRA C:2012 compliant code.  The final check for MISRA C:2012 would be
% performed by *Polyspace*, a static analysis tool that analyzes the 
% generated code.
%
%% Verification and Validation Tools Used
%
% * Simulink Check
%
%% Using Edit Time Checking
% 
% *Model Advisor* has a comprehensive set of checks that can be used to
% verify the model has been constructed and configured to ensure standards
% compliance as discussed above.  What if we could perform these checks 
% earlier in the development process?  It is possible to perform a subset 
% of these checks to detect compliance issues at design time.  There is a 
% feature called *edit-time checking* that will check the model as it is 
% being design or constructed. To enable *edit-time checking*, do the 
% following: 
%
% * Open the *CruiseControl_Req.slx* – 
% *<matlab:copyReqsMdl('CruiseControl_Req','CruiseControl_Req');open_system('CruiseControl_Req.slx') click here>*
%
% * Go to *Analysis/Model Advisor/Model Advisor/Display Advisor Checks in Editor*
%
% <<Step_02_EditTimeMenuEnable.png>>
%
% After *edit-time checking* has been enabled, the checks have been 
% automatically run and the results displayed on the model canvas.  
%
% Note the name violation found for the subsystem "Compute target speed".
% To fix the violation:
%
% * Remove the spaces in the block name by renaming the block to
% "ComputeTargetSpeed"
%
% <<Step_02_EditTimeModelIssue.png>>
%
% Open the state chart to find another violation regarding the "ON" state.
% To fix the violation:
%
% * Add a CR to place "engaged = true;" on a separate line.
%
% <<Step_02_EditTimeStateflowIssue.png>>
%
% Notice the "Accel" and "Coast" states have the same issue with the same
% fix:
%
% * For the "Accel" state, add a CR to place "tspeed = tspeed + incdec;" on
% a separate line.
% * For the "Coast" state, add a CR to place "tspeed = tspeed - incdec;" on
% a separate line.
%
% All issues identified by *Edit Time Checking* have been fixed.  Next we
% will use the *Metrics Dashboard* to perform a more detailed standards
% compliance check.
%% Opening the Metrics Dashboard
%
% For the all of the checks including the edit-time checks we will use the 
% *Metrics Dashboard* to determine and demonstrate if the model is in 
% compliance with
%
% * ISO 26262 
% * MAAB Style Guidelines
% * MISRA C:2012 
%
% The *Metrics Dashboard* collects and integrates quality metric data from 
% multiple Model-Based Design tools to provide you with an assessment of 
% your project quality status.  The *Metrics Dashboard* contains widgets 
% that provide visualization of metric data in these categories: size, 
% modeling guideline compliance, and architecture.
%
% Before we open the *Metrics Dashboard*, we will run a script to configure the
% dashboard to obtain compliance metrics for ISO 26262, MAAB and MISRA.
%
% 1.  Configure the *Metrics Dashboard* – *<matlab:setMetricsDashCfg(); click here>*
%
% 2.  If not opened, open the *CruiseControl_Req.slx* model – 
% *<matlab:B0_MdlAdv_ReqLink; click here>*
%
% If opened, model changes from the *edit-time checking* section will be 
% lost.
%
% 3.  To open the *Metrics Dashboard*, make the menu selection 
% *Analysis/Metrics Dashboard*
%
% <<Step_02_MA_Dashboard1.png>>
%
% 4.  Select *All Metrics* to analyze the model for standards compliance.
%
% A progress bar will popup to show what checks are being executed.  Once
% completed the compliance metrics will be shown on the *Metrics Dashboard*.
%
% <<Step_02_MA_Dashboard2.png>>
%
% To get help with understanding, interpreting and using the *Metrics Dashboard* - 
% *<matlab:web(fullfile(docroot,'slcheck/ug/collect-model-metric-data-by-using-the-metrics-dashboard.html')) click here>*
% *<matlab:web(fullfile(docroot,'slcheck/ug/collect-and-explore-metric-data-by-using-metrics-dashboard.html')) and here>*.
%
% From the dashboard metrics our model is (92.4%) MAAB compliant. We
% will now drill down into the MAAB results, fix the issues and demonstrate
% 100% MAAB compliance.
%
% 5.  To drill down into the MAAB results, select the "MAAB" gauge to bring
% up the *Metrics Details* view.
%
% <<Step_02_MA_DashboardGrid.png>>
%
% The *Metrics Details* starts in the *Grid* view.  This can be very useful
% for integrations of a large number of components or models to see how many
% components are non-compliant and if the issues are localized or across the
% organization.  In our case we are analyzing a single component so we will
% proceed to the *Table* view with an itemized list of issues.
%
% 6.  Select *Table* in the toolstrip to show the list of issues.
%
% <<Step_02_MA_DashboardTable.png>>
%
%% Fixing the Non-Compliant Checks 
%
% We will use *Model Advisor* to determine the cause of the non-compliance
% and fix the issues.
%
% 1.  From the *Metrics Detail* view, select *Open results in Model Advisor* 
% to open *Model Advisor*.
%
% Before we investigate and fix these issues we need to create a *restore point* 
% so if we decide on a different strategy to handle these issues then we
% can easily go back to our last "good" model.
%
% 2.  To create a *restore point* in *Model Advisor*, select *File/Save
% Restore Point*
%
% <<Step_02_MA_RestorePoint.png>>
%
% 3.  In the *Metrics Dashboard*  select "Check font formatting"
%
% *Model Advisor* will show the "Check font formatting" check within the 
% "Modeling Standards for MAAB/Simulink" section.
%
% <<Step_02_MA_FontCheck.png>>
%
% Note: Your list of checks might be slightly different than the screen
% shot. The list of checks is a function of installed products. 
%
% There are (6) warnings* for the "MAAB Checks".  Let's take a 
% look at what is causing these warning messages:
%
% * *Check font formatting*REPLACE_WITH_DASH_DASH usage of two font sizes in model; consistency
% * *Check model diagnostic parameters*REPLACE_WITH_DASH_DASH  (2) diagnostics need to be set
% to warning or error; workflow, code generation
% * *Check for diagram using nonstandard display attributes*REPLACE_WITH_DASH_DASH several
% issues, use *Modify* button to fix; consistency
% * *Check for propagated signal labels*REPLACE_WITH_DASH_DASH outport signals need to be set for
% label propagation; readability, code generation, verification & validation
% * *Check default transition placement in Stateflow charts*REPLACE_WITH_DASH_DASH default state
% not the top-most state; readability
% * *Check for comparison operations in Stateflow charts*REPLACE_WITH_DASH_DASH value is not cast
% to the same type as the signal (uint8), change to *tspeed!=uint8(0)*: 
% code generation, verification & validation
%
% For more detail on any check, select the *Help* button in the *Model
% Advisor* check pane.  You can also
% <http://www.mathworks.com/automotive/standards/maab.html download the 
% MAAB style guide> from the web for more detailed information. 
%
% 4.  First, let's fix "Check font formatting" by 
%
% * Selecting *Run This Check*
% * Selecting *Modify All Fonts*
% * Selecting *Run This Check*
%
% The "Check font formatting" check should now pass.  
%
% Follow this general method to fix the remaining checks except for "Check 
% default transition placement in Stateflow charts".  For this check we 
% will use an exclusion method.  For the other checks, after *Run This Check* 
% there will typically be some type of a "Fix It" button or hyperlinks to
% navigate to the violation in the model or configuration where the fix can
% manually be made.
%
% 5.  In *Model Advisor*, navigate through the non-compliant "MAAB" checks 
% to fix all the checks using the hints above.  Excluding  "Check default 
% transition placement in Stateflow charts" do this for the remaining  
% checks.
%
%% Excluding Blocks from Model Advisor Analysis
%
% If you want to exclude a check, you simply uncheck it and it will be
% exluded from the analysis. You can also put together a custom list of
% checks to only run those that you think make sense for you. This is
% covered in the last section of this step.
%
% However, sometimes you want to run a check on a model, but exclude only
% specific blocks or specific block types from all checks or individual
% checks. This is required to show (100%) compliance in the *Metrics 
% Dashboard*.  The *Check default transition placement in Stateflow charts* 
% is a good candidate for exclusion since this may require a major rework 
% of the the Stateflow chart.  We will now show how to exclude this block
% to enable us to pass all the MAAB checks.  We would likely 
% still have to justify this during the model review but as we will see
% the use of exclusion is documented in the final report.
%
% 1.  In *Model Advisor*, navigate to the "Stateflow" section and select 
% *Check default transition placement in Stateflow charts*
%
% <<Step_02_MA_DefaultPlacement.png>>
% 
% The *Recommended Action* is to rearrange the states so the default state 
% is the top-most state. Place the destination state of the default 
% transition above all other states in the state hierarchy.  However, let's
% say that we approve this deviation from the MAAB standard  for our model.  
% To do this, follow the steps below:
% 
% 2.  Select one of the non-compliant states to navigate to the model 
%
% 3.  Navigate up one level and select the state chart
%
% 4.  Right-click the state chart block and select *Model Advisor/Exclude
% block only/Select checks ...*
%
% 5.  Find *Check default transition placement in Stateflow charts* in the
% list box.  Look at the relative position in the list box to help find the
% check (see picture below): 
%
% <<Step_02_MA_ExcludeDefPlaceSelector.png>>
%
% This opens the *Model Advisor Exclusion Editor* 
%
% <<Step_02_ExclusionDialog.png>>
%
% 6.  Click the *Change* button to name the exclusion file
%
% 7.  Click *Save as* in the dialog that appears, name the file 
% *CruiseControl_Req_exclusions.xml*
%
% 8. Rerun the check *Check default transition placement in Stateflow charts* 
% under *Model Architecture* to confirm that this check now passes.
% 
% 9.  Return to the *Metrics Dashboard* and select *Dashboard* in the 
% toolstrip to return to the dashboard view.
%
% 10.  Run *All Metrics* to confirm (100%) MAAB compliance.
%
% <<Step_02_MA_DashboardPass.png>>
%
%% Adding Custom Checks to Model Advisor
%
% As mentioned at the beginning of this section, *Simulink Check* allows 
% users to add customized checks to Model Advisor. This is done through the
% Model Advisor API and the *sl_customization.m* file.  For this workshop, 
% three new custom checks will be added based on the MATLAB code in 
% *sl_customization.m* file.
%
% To use custom checks do the following:
%
% 1.  Close *Model Advisor* and the *Metrics Dashboard*
%
% 2.  Save *CruiseControl_Req.slx* – *<matlab:save_system('CruiseControl_Req.slx') click here>*
%
% 3.  Close all model files – *<matlab:bdclose('all'); click here>*  
%
% 4.  Setup the *sl_customization.m* file – *<matlab:setupCustomMAchecks;
% click here>* (this copies sl_customization.m into the working dir)
%
% 5.  To view *sl_customization.m* - *<matlab:edit('sl_customization.m');
% click here>*
%
% 6.  At the MATLAB command prompt, enter the following command:  
%
% >> *Advisor.Manager.refresh_customizations* *<matlab:Advisor.Manager.refresh_customizations or click here>*
%
% 7.  Open the *CruiseControl_Req.slx* – *<matlab:open_system('CruiseControl_Req.slx') click here>*
%
% 8.  Configure the *Metrics Dashboard* for the new custom checks – 
% *<matlab:setMetricsDashCfgCustom(); click here>*
%
% 9.  Re-open the *Metrics Dashboard*.
% 
% 10.  Select *All Metrics* to run all metrics including the new custom checks
%
% <<Step_02_MA_DashboardCustom.png>>
% 
% Notice the third gauge has been reassigned from "MISRA" to "Workshop" to
% indicate the status of the custom checks.
%
% 11.  Select the "Workshop" gauge to open *Metrics Details* view.
%
% 12.  Select "Open results in Model Advisor" to see the custom checks in
% *Model Advisor*
%
% <<Step_02_MA_CustomChecks.png>>
%
% A new folder has appeared under *By Product* named *Custom Workshop Checks*
% The folder contains the 3 custom checks:
%
% * Check Simulink block font
% * Check Simulink window screen color
% * Check model optimization settings
%
% 13. Run through all three of these custom checks and notice the different 
% displays and fix actions for each check.
%
% In some cases, it is possible have a "*Fix ...*" action, in which 
% Model Advisor would follow a pre-defined or programmed fix action to 
% correct the model for you. Since font type and size have a very "objective" 
% procedure to fix the model, we can implement a "*Fix ...*" action.   
%
% These checks were scripted in MATLAB using the *Model Advisor* API commands,
% and added to the *Model Advisor* UI using the "sl_customization.m" file. 
% When "sl_customization.m" changes, the UI must be refreshed with the
% *Advisor.Manager.refresh_customizations* command.
%% Customizing Model Advisor Menu
%
% In addition to being able to add your own checks, you can also configure
% the Model Advisor menu with different folders, or different initial check
% configurations (enable/disable/hidden). 
%
% Do the following:
%
% 1.  Open *Model Advisor* and select the menu *Settings/Open Configuration
% Editor*.
% 
% <<Step_02_ConfigurationEditorMenu.png>>
%
% You should see the following windows open up:
%
% <<Step_02_MA_ConfigurationEditor.png>>
% 
% You can now modify (drag and drop) the check tree structure in the
% left-hand window using the checks available in the right-hand window. 
% 
% 2.  Drag and drop check from Right (Source) window to the Left
% (Destination) window.
%
% 3.  Create and delete folders in the left window.
%
% 4.  Enable or disable specific checks in the left window.
%
% <<Step_02_MA_CfgEditorDragDrop.png>>
%
% Once you are done, you can save the configuration as a *.mat* file, and
% share the configuration setting with others. 
%
% 5.  Select *File/Save As* and save the configuration as 
% *CruiseControl_MA_Config.mat*.
%
% Now that you have a custom Model Advisor configuration, let's use it.
%
% 7.  Select *File/Set Current Configuration as Default*, also press
% *OK* to warning popup
%
% 8.  Exit the *Model Advisor Configuration Editor* and reopen *Model
% Advisor*
%
% <<Step_02_MA_CustomConfig.png>>
%
% 9.  Another way to load your custom Model Advisor configuration REPLACE_WITH_DASH_DASH In the
% *Model Advisor* window, under *Settings*, select *Load Configuration...*
%
% 10. To restore default settings REPLACE_WITH_DASH_DASH In *Model Advisor* window, under 
% *Settings*, select *Restore Default Configuration*.
%
%% Summary
%
% With the functions above, we were able to check our Cruise Control model 
% for compliance with industry, international and company standards, and best 
% practices.  We were able to carry out this task using the base Simulink,
% Model Advisor tool along with the modeling standards checks provided by 
% *Simulink Verification and Validation*.  
%
% In the exercises we demonstrated compliance to the MAAB modeling standard.   
% The benefits of complying to the MAAB modeling standard include 
% readability, making the model production code ready, 
% facilitating a standard V&V workflow and enabling re-use.  Additional 
% checks for complying to a safety standard like ISO 26262 are also 
% available to be used as part of an overall process to demonstrate ISO 
% 26262 compliance. The safety standards were not part of the exercises
% but the same procedure used in the MAAB exercises would apply to
% demonstrating compliance to the safety standard. 
%
% The standards checking can be customized to fit your model-based design
% process.  Methods used to provide this customization to your process were 
% also demonstrated:
%
% # Custom checks can be created to check models for internal modeling
% standards
% # Custom model checking configurations can include only the checks that 
% apply or provide benefit to your workflow
%
% Going forward we have increased confidence in our design knowing that are
% model follows a modeling standard.  We have now answered all the questions as we have now 
% demonstrated a structured and formal testing framework for securing the 
% quality, robustness and safety of our cruise controller.
% 
% <<Step_02_CruiseControl_Summary.png>>
%
% # Close all models - *<matlab:bdclose('all'); click here>*.
% # Go to *Step 3: Detecting Design Errors* - *<Step_03.html click here>*.
%
##### SOURCE END #####
--></body></html>